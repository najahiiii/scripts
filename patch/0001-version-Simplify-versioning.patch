From 605cf5c969409871753808ed1e10dd33c82159af Mon Sep 17 00:00:00 2001
From: Ahmad Thoriq Najahi <najahi@zephyrus.id>
Date: Fri, 29 Jan 2021 00:41:37 +0700
Subject: [PATCH] version: Simplify versioning

Signed-off-by: Ahmad Thoriq Najahi <najahi@zephyrus.id>
---
 clang/lib/Basic/Version.cpp | 10 ++--------
 lld/Common/Version.cpp      |  8 +-------
 llvm/CMakeLists.txt         |  2 +-
 3 files changed, 4 insertions(+), 16 deletions(-)

diff --git a/clang/lib/Basic/Version.cpp b/clang/lib/Basic/Version.cpp
index af3118b0f6da..286e6df0dc9a 100644
--- a/clang/lib/Basic/Version.cpp
+++ b/clang/lib/Basic/Version.cpp
@@ -23,10 +23,10 @@ namespace clang {
 
 std::string getClangRepositoryPath() {
 #if defined(CLANG_REPOSITORY_STRING)
-  return CLANG_REPOSITORY_STRING;
+  return "";
 #else
 #ifdef CLANG_REPOSITORY
-  return CLANG_REPOSITORY;
+  return "";
 #else
   return "";
 #endif
@@ -35,24 +35,18 @@ std::string getClangRepositoryPath() {
 
 std::string getLLVMRepositoryPath() {
 #ifdef LLVM_REPOSITORY
-  return LLVM_REPOSITORY;
-#else
   return "";
 #endif
 }
 
 std::string getClangRevision() {
 #ifdef CLANG_REVISION
-  return CLANG_REVISION;
-#else
   return "";
 #endif
 }
 
 std::string getLLVMRevision() {
 #ifdef LLVM_REVISION
-  return LLVM_REVISION;
-#else
   return "";
 #endif
 }
diff --git a/lld/Common/Version.cpp b/lld/Common/Version.cpp
index ec6eda6a6748..2b31bf70be8c 100644
--- a/lld/Common/Version.cpp
+++ b/lld/Common/Version.cpp
@@ -18,11 +18,5 @@
 // LLD 14.0.0 (https://github.com/llvm/llvm-project.git
 // 2d9759c7902c5cbc9a7e3ab623321d5578d51687)
 std::string lld::getLLDVersion() {
-#ifdef LLD_VENDOR
-#define LLD_VENDOR_DISPLAY LLD_VENDOR " "
-#else
-#define LLD_VENDOR_DISPLAY
-#endif
-  return LLD_VENDOR_DISPLAY "LLD " LLD_VERSION_STRING;
-#undef LLD_VENDOR_DISPLAY
+return "LLD " LLD_VERSION_STRING;
 }
diff --git a/llvm/CMakeLists.txt b/llvm/CMakeLists.txt
index 50ba9b3be1b8..86d6c7aab258 100644
--- a/llvm/CMakeLists.txt
+++ b/llvm/CMakeLists.txt
@@ -20,7 +20,7 @@ if(NOT DEFINED LLVM_VERSION_PATCH)
   set(LLVM_VERSION_PATCH 0)
 endif()
 if(NOT DEFINED LLVM_VERSION_SUFFIX)
-  set(LLVM_VERSION_SUFFIX git)
+  set(LLVM_VERSION_SUFFIX "")
 endif()
 
 if (NOT PACKAGE_VERSION)
-- 
2.30.2

